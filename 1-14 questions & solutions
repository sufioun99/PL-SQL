------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1. Create compile and invoke the ADD_JOB procedure and review the results.

CREATE OR REPLACE PROCEDURE 
add_jobs( p_jobid  jobs.job_id%type, p_jobtitle  jobs.job_title%type) IS
BEGIN
  INSERT INTO  jobs (job_id,job_title)
  VALUES (p_jobid, p_jobtitle);
  COMMIT;
END add_jobs;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
EXECUTE add_job ('IT_DBA', 'Database Administrator')
SELECT * FROM jobs WHERE job_id = 'IT_DBA';
EXECUTE add_job ( 'ST_MAN' , Stock Manager')
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2) Create a procedure called UPD_JOB to modify a job in the JOBS table.

CREATE OR REPLACE PROCEDURE upd_job( p_jobid IN jobs.job_id%type, p_jobtitle IN jobs.job_title%type) IS
BEGIN 
  UPDATE jobs 
  SET job_title = p_jobtitle
  WHERE job_id = p_jobid;
  IF SQL%NOTFOUND THEN 
    RAISE_APPLICATION_ERROR(-20202,'No job updated.');
END IF;
END upd_job;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
EXECUTE upd_job ('IT_DBA', 'Data Administration')
SELECT * FROM jobs WHERE job_id = 'IT_DBA';
EXECUTE upd_job ('IT_WEB', 'Web Master')
SELECT * FROM jobs WHERE job_id = 'IT_WEB';

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3) Create a procedure called DEL_JOB to delete a job from the JOBS table.

CREATE OR REPLACE PROCEDURE del_job (p_jobid jobs.job_id%type) IS 
BEGIN 
  DELETE FROM jobs 
  WHERE job_id = p_jobid;
  IF SQL%NOTFOUND THEN 
    RAISE_APPLICATION_ERROR(-20203,'No job deleted.');
END IF;
END del_job;
/
EXECUTE del_job ('IT_DBA')
SELECT * FROM jobs WHERE job_id = 'IT_DBA';
EXECUTE del_job ('IT_WEB')
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

4) Create a procedure called GET_EMPLOYEE to query the EMPLOYEES table.

CREATE OR REPLACE PROCEDURE get_employee
(p_empid IN employees.employee_id%type, p_sal OUT employees.salary%type, p_job OUT employees.job_id%type) IS
BEGIN 
SELECT salary , job_id
INTO p_sal, p_job
FROM employees
WHERE employee_id = p_empid;
END get_employee;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
variable v_sal number 
variable v_job varchar2(15)
execute get_employee(120, :v_sal,:v_job)
print v_sal v_job
execute get_employee(300, :v_sal,:v_job)
print v_salary v_job

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5) Create a procedure called RAISE_SALARY to increase the employee salary.

CREATE OR REPLACE PROCEDURE raise_salary
(p_id IN employees.employee_id%TYPE, p_percent IN NUMBER) IS 
BEGIN 
UPDATE employees
SET salary = salary * (1 + p_percent/100)
WHERE employee_id = p_id;
END raise_salary;
/
select last_name, salary from employees where employee_id = 176;
EXECUTE raise_salary(176, 10);
select last_name, salary from employees where employee_id = 176;

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
6) Create a procedure called QUERY_EMP to query the employee last_name and salary from the EMPLOYEES table.

 CREATE OR REPLACE PROCEDURE 
query_emp (p_id IN employees.employee_id%TYPE, p_name OUT employees.last_name%TYPE, p_salary OUT employees.salary%TYPE) IS 
BEGIN SELECT last_name, salary INTO p_name, p_salary 
FROM employees 
WHERE employee_id = p_id; 
END query_emp; 
/

------------------------------used to check if the procedure is working or not ----------------------
DECLARE
v_emp_name employees.last_name%TYPE;
v_emp_sal employees.salary%TYPE;
BEGIN
query_emp(171, v_emp_name, v_emp_sal);
DBMS_OUTPUT.PUT_LINE(v_emp_name||' earns '||
to_char(v_emp_sal, '$999,999.00'));
END;
/

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
7) Create a procedure called ADD_DEPT for adding new department into DEPARTMENTS table.

CREATE OR REPLACE  PROCEDURE 
add_department(p_name VARCHAR2, p_mgr NUMBER, p_loc NUMBER) IS
BEGIN
INSERT INTO DEPARTMENTS (department_id,department_name, manager_id, location_id)
VALUES (DEPARTMENTS_SEQ.NEXTVAL, p_name, p_mgr, p_loc);
DBMS_OUTPUT.PUT_LINE('Added Dept: '|| p_name);
EXCEPTION
WHEN OTHERS THEN
DBMS_OUTPUT.PUT_LINE('Err: adding dept: '|| p_name);
END;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE PROCEDURE create_departments IS
BEGIN
add_department('Media', 100, 1800);
add_department('Editing', 99, 1800);
add_department('Advertising', 101, 1800);
END;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

8) Create and invoke the GET_SAL function with a single input parameter and to returns the salary of inputted employee.

CREATE OR REPLACE FUNCTION get_sal
(p_id employees.employee_id%TYPE) RETURN NUMBER IS
v_sal employees.salary%TYPE := 0;
BEGIN
SELECT salary
INTO v_sal
FROM employees
WHERE employee_id = p_id;
RETURN v_sal;
END get_sal;
/

EXEC DBMS_OUTPUT.PUT_LINE(get_sal(100))
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

9) Create and invoke the TAX function with a single input parameter and to returns the income tax based on simple flat tax rate for inputted salary.
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE FUNCTION tax(p_value IN NUMBER)
RETURN NUMBER IS
BEGIN
RETURN (p_value * 0.08);
END tax;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT employee_id, last_name, salary, tax(salary)
FROM employees
WHERE department_id = 100;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

10) Create and invoke the GET_JOB function to return a job title.
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CREATE OR REPLACE FUNCTION get_job
(p_jobid IN jobs.job_id%TYPE)
RETURN
jobs.job_title%TYPE
IS
v_jobtitle jobs.job_title%TYPE;
BEGIN
SELECT job_title
INTO v_jobtitle
FROM jobs
WHERE job_id = p_jobid;
RETURN v_jobtitle;
END get_job;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
EXEC DBMS_OUTPUT.PUT_LINE(get_job('ST_MAN'));

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

11 ) Create function called GET_ANNUAL_COMP to return the annual salary computed from employeeâ€™s monthly salary and commission passed as parameters.
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
create or replace function get_annual_comp
(p_sal IN employees.salary%type,
p_comm IN employees.commission_pct%type)
return number 
IS
begin
return(nvl(p_sal,0) * 12 + (nvl(p_comm,0) * 12));
end;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------/

select employee_id, last_name, 
get_annual_comp(salary, commission_pct) "Annual Compensation"
from employees
where department_id=30;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

12. To create the messages table.
write a PL/SQL block to insert number into the messages table.
a) insert the numbers 1 thorugh 10, excluding 6 and 8.
b) commit before the end of the block.
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
create table messages( Results Number(2));
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 BEGIN
 FOR i in 1..10 LOOP
 IF i=6 OR i=8 THEN
 NULL;
 ELSE
 INSERT INTO messages(results)
 VALUES(i);
 END IF;
 END LOOP;
 COMMIT;
 END;
 /
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
SELECT * FROM MESSAGES;

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
13. write a logic to append asterisk(*) to the string for every $1,000 of the salary. for example if the employee earns $8,000 the string of the string of asterisks should contain eight asterisk. 
if the employee earns $12,500 the string of asterisks should contain 13 asterisk.
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
CREATE TABLE emp AS SELECT * FROM employees;

DESC emp
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
ALTER TABLE emp 
ADD stars VARCHAR2(20);

DESC emp 
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
declare
 v_empno emp.employee_id%type := 176;
 v_asterisk emp.stars%type;
 v_sal emp.salary%type;
 begin
 select nvl(round(salary/1000),0) into v_sal
 from emp where employee_id = v_empno;
 for i in 1..v_sal
 loop
 v_asterisk :=v_asterisk||'*';
 end loop;
 update emp set stars = v_asterisk
 where employee_id = v_empno;
 commit;
 end;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 SELECT employee_id, salary, stars
 FROM emp WHERE employee_id =176;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
14. create a PL/SQL block that users an explicit cursor to determine the top n salaries of employees.
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
create table top_salaries(salary number(7));
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
declare
v_num NUMBER(3)  := 5;
v_sal employees.salary%type;
CURSOR c_emp_cursor IS
select salary
from employees
order by salary desc nulls last;
begin
open  c_emp_cursor;
fetch  c_emp_cursor into v_sal;
while c_emp_cursor%ROWCOUNT <= v_num AND c_emp_cursor%found LOOP
insert into top_salaries(salary)
values(v_sal);
fetch c_emp_cursor into v_sal;
end loop;
close c_emp_cursor;
end;
/
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
select * from  top_salaries;
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
